{{!-- views/landing.hbs --}}
<section class="landing-wrapper">

  <header class="landing-hero">
    <div class="hero-content">
      <h1>{{title}}</h1>
      <p class="subtitle">{{description}}</p>

      <!-- Updated CTA: points to auth signin with returnTo default to /recommend.
           JS below will add provider=facebook when it detects FB in-app. -->
      <a id="landingCta" href="/auth/signin?returnTo=/recommend" class="cta-button">Get Personalized Matches →</a>
    </div>
  </header>

  <section class="landing-section">
    <h2>Why Zimbabwean parents trust ZimEduFinder</h2>
    <ul>
      <li><strong>Smart matching:</strong> Our recommendation engine surfaces best-fit schools based on your child’s needs and your priorities.</li>
      <li><strong>Detailed filters:</strong> Search by curriculum, boarding/day, facilities (science labs, ICT, sports), and learning environment.</li>
      <li><strong>Local focus:</strong> Coverage of Harare, Bulawayo, Mutare and other Zimbabwe cities with data tailored for local searches.</li>
      <li><strong>Compare & contact:</strong> Side-by-side school comparisons and direct contact details to make decisions faster.</li>
    </ul>
  </section>

  <section class="landing-section">
    <h2>How it works</h2>
    <ol>
      <li><strong>Tell us what matters:</strong> city, curriculum, day/boarding, facilities and fees band.</li>
      <li><strong>Get matched:</strong> our algorithm ranks best-fit schools and explains matches with clear reasons.</li>
      <li><strong>Compare & contact:</strong> open profiles, compare features and contact the school directly.</li>
    </ol>
  </section>

  <section class="landing-section">
    <h2>Featured categories</h2>
    <div class="grid-featured" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:16px">
      <div class="card"><h3>Top Private Schools</h3><p>Strong academic performance and outstanding facilities.</p></div>
      <div class="card"><h3>Affordable Options</h3><p>Schools balancing quality and affordability across Zimbabwe.</p></div>
      <div class="card"><h3>Boarding Schools</h3><p>Trusted boarding options for families across the country.</p></div>
      <div class="card"><h3>Cambridge Schools</h3><p>Find CIE / Cambridge curriculum schools for global pathways.</p></div>
    </div>
  </section>

  <section class="landing-section">
    <h2>Frequently asked questions</h2>
    <div class="faq">
      <details>
        <summary>How accurate are the school profiles?</summary>
        <p>We verify school details from public data and manual checks. Schools can also update their profiles via our admin system.</p>
      </details>

      <details>
        <summary>Is Skoolfinder free to use?</summary>
        <p>Yes — parents can search and get recommendations for free.</p>
      </details>

      <details>
        <summary>Can I compare multiple schools?</summary>
        <p>Yes. Browse schools, add to comparison, and view them side-by-side.</p>
      </details>
    </div>
  </section>

  <footer class="landing-section">
    <p style="font-size:0.95rem;color:#666">
      ZimEduFinder - Zimbabwe’s smart private school matching platform.
    </p>
  </footer>

</section>

<style>
/* Wrapper */
.landing-wrapper { max-width:1100px;margin:0 auto;padding:36px 18px;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto }

/* Hero */
.landing-hero { background:linear-gradient(135deg,#003f8a,#007bff);padding:72px 20px;border-radius:14px;color:#fff;text-align:center;margin-bottom:36px }
.hero-content h1{font-size:2.6rem;margin:0 0 12px}
.hero-content .subtitle{font-size:1.125rem;opacity:0.95;margin-bottom:20px}
.cta-button{display:inline-block;background:#fff;color:#003f8a;padding:12px 26px;border-radius:999px;font-weight:700;text-decoration:none;box-shadow:0 6px 18px rgba(0,0,0,0.08)}
.cta-button[style]{border:2px solid rgba(255,255,255,0.9);background:transparent}

/* Sections */
.landing-section{margin:28px 0}
.landing-section h2{font-size:1.4rem;color:#222;margin-bottom:10px}
.landing-section p, .landing-section li{color:#444;line-height:1.6}

/* Cards / Grid */
.grid-featured .card{background:#fff;border:1px solid #eef2f7;padding:14px;border-radius:10px;box-shadow:0 4px 12px rgba(10,20,40,0.03)}
.faq details{margin-bottom:10px;border-left:3px solid #e6eefc;padding:10px 12px}
</style>

<script>
  (function () {
    // Client-side detection for Facebook / Instagram in-app browsers
    function isFacebookInApp() {
      const ua = (navigator.userAgent || '').toLowerCase();
      const ref = (document.referrer || '').toLowerCase();
      // broad fingerprints used by FB / IG in-app browsers
      return /\bfbav\b|\bfban\b|facebook|messenger|instagram|fb_iab|fb_iab_ios|fb_iab_android|okhttp/i.test(ua) || ref.includes('facebook.com');
    }

    const cta = document.getElementById('landingCta');
    if (!cta) return;

    // if inside FB in-app, hint provider=facebook so server starts FB OAuth explicitly
    if (isFacebookInApp()) {
      const base = '/auth/signin';
      const params = new URLSearchParams({
        provider: 'facebook',
        returnTo: '/recommend'
      });
      cta.href = base + '?' + params.toString();
      // optional label change for clarity
      cta.textContent = 'Get Personalized Matches (Facebook) →';
    } else {
      // default: go to auth signin; server will prefer Google where appropriate,
      // or user can be redirected to /recommend after login.
      cta.href = '/auth/signin?returnTo=/recommend';
    }
  })();
</script>
